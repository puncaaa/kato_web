{% extends 'website/base.html' %}
{% load static %}
{% block content %}

<!-- Hero -->
<section id="hero" class="hero-section reveal-on-scroll d-flex align-items-center"
  style="background: linear-gradient(135deg, #f0f7ff 0%, #ffffff 100%); min-height: 80vh; padding: 4rem 0;">
  <div class="container">
    <div class="row align-items-center g-5">
      <div class="col-lg-6">
        <div class="badge bg-primary bg-opacity-10 text-primary mb-3 px-3 py-2 rounded-pill fw-semibold">Ассоциация
          травматологов и ортопедов РК</div>
        <h1 class="display-4 fw-bold mb-4" style="color: #1a2e44; line-height: 1.2;">Инновации в травматологии<br>и
          ортопедии Казахстана</h1>
        <p class="lead text-muted mb-4" style="font-size: 1.25rem;">Объединяем профессионалов, внедряем передовые
          технологии и повышаем качество медицинской помощи по всей стране.</p>
        <div class="d-flex gap-3">
          <a href="{% url 'events_list' %}" class="btn btn-primary btn-lg rounded-pill shadow-sm">Ближайшие
            конференции</a>
          <a href="{% url 'membership' %}" class="btn btn-outline-primary btn-lg rounded-pill">Стать участником</a>
        </div>

        <div class="mt-5 d-flex gap-4 border-top pt-4">
          <div>
            <div class="h3 fw-bold text-primary mb-0">550+</div>
            <small class="text-muted">Врачей в ассоциации</small>
          </div>
          <div>
            <div class="h3 fw-bold text-primary mb-0">9</div>
            <small class="text-muted">Региональных филиалов</small>
          </div>
          <div>
            <div class="h3 fw-bold text-primary mb-0">20+</div>
            <small class="text-muted">Лет истории</small>
          </div>
        </div>
      </div>
      <div class="col-lg-6 position-relative">
        <div
          style="background: var(--primary-color); position: absolute; top: -20px; right: -20px; width: 100px; height: 100px; opacity: 0.1; border-radius: 50%; z-index: 0;">
        </div>
        <img src="{% static 'website/img/hero-conference.png' %}" alt="Конференция КАТО"
          class="img-fluid rounded-4 shadow-lg position-relative" style="z-index: 1;">
      </div>
    </div>
  </div>
</section>

<!-- Upcoming Event Teaser (if any) -->
{% if upcoming_events %}
<section class="py-5 bg-white">
  <div class="container">
    <div class="row justify-content-center">
      <div class="col-lg-10">
        <div class="card border-0 shadow-sm bg-primary text-white overflow-hidden">
          <div class="card-body p-4 p-md-5 d-md-flex align-items-center justify-content-between position-relative">
            <!-- Decorative circle -->
            <div
              style="position: absolute; top: -50px; right: -50px; width: 200px; height: 200px; background: rgba(255,255,255,0.1); border-radius: 50%;">
            </div>

            <div class="position-relative z-1 mb-3 mb-md-0">
              <span class="badge bg-white text-primary mb-2">Ближайшее событие</span>
              <h3 class="mb-1 text-white">{{ upcoming_events.0.title }}</h3>
              <p class="mb-0 opacity-75">{{ upcoming_events.0.date|date:"d E Y" }} • {{ upcoming_events.0.location }}
              </p>
            </div>
            <div class="position-relative z-1">
              <a href="{% url 'event_detail' upcoming_events.0.slug %}"
                class="btn btn-light rounded-pill px-4 fw-bold text-primary">Подробнее</a>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>
{% endif %}

<!-- News Carousel -->
<section id="news" class="py-5 reveal-on-scroll">
  <div class="container">
    <div class="d-flex justify-content-between align-items-end mb-4">
      <div>
        <h2 class="mb-1 fw-bold">Новости Ассоциации</h2>
        <p class="text-muted mb-0">Главные события и обновления</p>
      </div>
      <a href="{% url 'news_list' %}" class="btn btn-outline-primary rounded-pill">Все новости</a>
    </div>

    <div id="newsCarousel" class="carousel slide shadow rounded-4 overflow-hidden bg-white" data-bs-ride="carousel">
      <div class="carousel-indicators">
        {% for n in latest_news|slice:":5" %}
        <button type="button" data-bs-target="#newsCarousel" data-bs-slide-to="{{ forloop.counter0 }}"
          class="{% if forloop.first %}active{% endif %}" aria-current="true"
          aria-label="Slide {{ forloop.counter }}"></button>
        {% endfor %}
      </div>
      <div class="carousel-inner">
        {% for n in latest_news|slice:":5" %}
        <div class="carousel-item {% if forloop.first %}active{% endif %}">
          <div class="row g-0">
            <div class="col-lg-7" style="min-height: 400px;">
              {% if n.image %}
              <img src="{{ n.image.url }}" class="d-block w-100 h-100" alt="{{ n.title }}"
                style="object-fit: cover; min-height: 400px;">
              {% else %}
              <div class="d-block w-100 h-100 bg-secondary d-flex align-items-center justify-content-center text-white">
                <i class="bi bi-image fs-1 opacity-50"></i>
              </div>
              {% endif %}
              <!-- Mobile overlay gradient -->
              <div class="d-lg-none position-absolute bottom-0 start-0 w-100 h-50"
                style="background: linear-gradient(to top, rgba(0,0,0,0.8), transparent);"></div>
            </div>
            <div class="col-lg-5 d-flex align-items-center bg-white">
              <div class="p-4 p-lg-5">
                <div class="d-flex align-items-center mb-3">
                  <span class="badge bg-primary-subtle text-primary border border-primary-subtle rounded-pill px-3">{{
                    n.category.name|default:"Новости" }}</span>
                  <small class="text-muted ms-3">{{ n.created_at|date:"d.m.Y" }}</small>
                </div>
                <h3 class="fw-bold mb-3 text-dark">{{ n.title }}</h3>
                <p class="text-muted mb-4 d-none d-md-block">{{ n.content|striptags|truncatewords:25 }}</p>
                <a href="{% url 'news_detail' n.slug %}" class="btn btn-primary rounded-pill px-4 stretched-link">Читать
                  подробнее</a>
              </div>
            </div>
          </div>
        </div>
        {% empty %}
        <div class="carousel-item active">
          <div class="d-flex align-items-center justify-content-center bg-light" style="height: 400px;">
            <p class="text-muted">Новостей пока нет</p>
          </div>
        </div>
        {% endfor %}
      </div>
      <button class="carousel-control-prev" type="button" data-bs-target="#newsCarousel" data-bs-slide="prev">
        <span class="carousel-control-prev-icon bg-dark rounded-circle p-2 bg-opacity-25" aria-hidden="true"></span>
        <span class="visually-hidden">Предыдущий</span>
      </button>
      <button class="carousel-control-next" type="button" data-bs-target="#newsCarousel" data-bs-slide="next">
        <span class="carousel-control-next-icon bg-dark rounded-circle p-2 bg-opacity-25" aria-hidden="true"></span>
        <span class="visually-hidden">Следующий</span>
      </button>
    </div>
  </div>
</section>

<!-- Quick access Grid -->
<section class="py-5 bg-light reveal-on-scroll">
  <div class="container">
    <h2 class="text-center mb-5">Ресурсы для врачей</h2>
    <div class="row g-4">
      <div class="col-md-4">
        <a href="{% url 'publications_list' %}"
          class="card h-100 p-4 border-0 shadow-sm text-decoration-none card-hover-effect">
          <div class="mb-3 text-primary">
            <!-- Icon placeholder (using emoji or svg later) -->
            <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 24 24" fill="none"
              stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
              <path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20"></path>
              <path d="M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"></path>
            </svg>
          </div>
          <h4 class="fw-bold text-dark">Библиотека знаний</h4>
          <p class="text-muted mb-0">Клинические протоколы, научные статьи и записи вебинаров доступны для членов КАТО.
          </p>
        </a>
      </div>
      <div class="col-md-4">
        <a href="{% url 'events_list' %}"
          class="card h-100 p-4 border-0 shadow-sm text-decoration-none card-hover-effect">
          <div class="mb-3 text-primary">
            <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 24 24" fill="none"
              stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
              <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
              <line x1="16" y1="2" x2="16" y2="6"></line>
              <line x1="8" y1="2" x2="8" y2="6"></line>
              <line x1="3" y1="10" x2="21" y2="10"></line>
            </svg>
          </div>
          <h4 class="fw-bold text-dark">Календарь событий</h4>
          <p class="text-muted mb-0">Расписание предстоящих конференций, мастер-классов и симпозиумов.</p>
        </a>
      </div>
      <div class="col-md-4">
        <a href="{% url 'membership' %}"
          class="card h-100 p-4 border-0 shadow-sm text-decoration-none card-hover-effect">
          <div class="mb-3 text-primary">
            <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 24 24" fill="none"
              stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
              <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>
              <circle cx="9" cy="7" r="4"></circle>
              <path d="M23 21v-2a4 4 0 0 0-3-3.87"></path>
              <path d="M16 3.13a4 4 0 0 1 0 7.75"></path>
            </svg>
          </div>
          <h4 class="fw-bold text-dark">Членство</h4>
          <p class="text-muted mb-0">Преимущества вступления, типы членства и онлайн-заявка.</p>
        </a>
      </div>
    </div>
  </div>
</section>

<!-- Partners grid -->
<section class="py-5 reveal-on-scroll">
  <div class="container text-center">
    <small class="text-uppercase tracking-wider text-muted fw-bold mb-4 d-block">Наши партнеры</small>
    <div class="row justify-content-center align-items-center opacity-75 grayscale-hover g-5">
      <div class="col-4 col-md-2 h5 mb-0 text-muted">KazMedic</div>
      <div class="col-4 col-md-2 h5 mb-0 text-muted">MedSupport</div>
      <div class="col-4 col-md-2 h5 mb-0 text-muted">MinZdrav</div>
      <div class="col-4 col-md-2 h5 mb-0 text-muted">OrthoGroup</div>
      <div class="col-4 col-md-2 h5 mb-0 text-muted">TraumaCenter</div>
    </div>
  </div>
</section>

{% endblock %}